<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <style>
        /* Optional: Add some basic styling */
        body {
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>

<h1>Admin Dashboard</h1>

<h2>Users</h2>
<table>
    <thead>
        <tr>
            <th>Username</th>
            <th>Role</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td>{{ user.username }}</td>
            <td>{{ user.role }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Button to open the user creation form in a popup window -->
<button onclick="openUserCreationPopup()">Create New User</button>

<!-- JavaScript to handle the popup -->
<script>
    function openUserCreationPopup() {
        // Set the window dimensions
        var width = 600;
        var height = 400;

        // Calculate the position to center the window on the screen
        var left = (window.innerWidth / 2) - (width / 2);
        var top = (window.innerHeight / 2) - (height / 2);

        // Open a new window with specified dimensions and centered position
        var popup = window.open(
            'about:blank',  // Temporarily open an empty page, we will load the form in it
            'CreateUserPopup',  // Name of the popup window
            `width=${width},height=${height},top=${top},left=${left},scrollbars=yes`
        );

        // Define the content of the popup (form for creating a user)
        var formContent = `
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Create New User</title>
            </head>
            <body>
                <h2>Create New User</h2>
                <form method="POST" action="{{ url_for('admin.add_new_user') }}">
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="name" required><br><br>

                    <label for="username">Username:</label>
                    <input type="text" id="username" name="username" required><br><br>

                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password" required><br><br>

                    <label for="role">Role:</label>
                    <select id="role" name="role" required>
                        <option value="admin">Admin</option>
                        <option value="worker">Worker</option>
                        <option value="clinician">Clinician</option>
                    </select><br><br>

                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required><br><br>

                    <button type="submit">Create User</button>
                    <button type="button" onclick="window.close()">Close</button>
                </form>
            </body>
            </html>
        `;

        // Write the form content to the new popup window
        popup.document.write(formContent);
    }
</script>
{% if error %}
    <p style="color:red;">{{ error }}</p>
{% endif %}
</body>
</html>
